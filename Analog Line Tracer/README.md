# アナログライントレーサー製作ログ

[回路シミュレータ(Falstad)へのリンク](https://www.falstad.com/circuit/.)  
フォトダイオードの代用として1mAの定電流源を設定してシミュレーションを実施。

## 開発の経緯と試行錯誤
* **初期の課題:** 片側フォトダイオードの黒線と白紙での出力差があまり無かった。
* **試行:** 苦肉の策でCdS（硫化カドミウムセル）を追加。
* **結果:** CdSは反応速度の問題があったため、**廃止**を決定。
* **現在:** ブレーキ回路を復活させ、センサー部に黒マニキュアで遮光するなどの措置を追加して安定化。

* [作製回路のシミュレータ(Falstad)上での表示短縮リンク(https://tinyurl.com/22tc2qaz) 
* [S字クランクをゆっくり曲がる様子 (Google Drive)]hthttps://drive.google.com/file/d/1PoD4iLnwC50FipKnk3lIsyK8fCd61m8f/view?usp=drive_link)

## 12/15時点の改修の内容まとめ
1. 改修の背景：慣性によるオーバーランの抑制
以前のバージョンでは、ライン検知後にモーターへの通電を切る（フリーラン）のみの制御だったため、機体の慣性でラインを通り過ぎてしまい、急カーブでの追従性が低い課題がありました。 これを解決するため、モーターの端子間を短絡させて電磁ブレーキをかける「ショートブレーキ回路」の再実装を決定しました。

3. 実装内容：ブレーキ回路の組み込み
回路変更:
センサーが「黒」を検知した際、逆起電力を利用して瞬時に回転を停止させる回路を追加。
トランジスタのスイッチングロジックを見直し、反応速度を向上。

4. トラブルシューティング：塗装によるセンサー干渉の解決
実装後の筐体仕上げ（塗装）工程において、以下の不具合が発生し、解決を行いました。
発生した不具合:
電源投入後、片側のモーターが常にロック（ブレーキ状態）され、動作しない現象が発生。
原因究明:
回路上の電気的ショートを疑ったが異常なし。
センサー（フォトトランジスタ）の受光部を確認したところ、仕上げ用塗料（マニキュア）がレンズ先端まで覆っており、外光が遮断されていた。
これにより、センサーが常に「ライン上（黒）」であると誤判定し、常時ブレーキ信号が出力されていたことが判明。
対策と結果:
レンズ表面の塗膜を除去し、光路を確保。
正常に白黒判定が行われるようになり、ブレーキ動作も設計通り機能することを確認。

4. 現在のステータス
急カーブにおいてもオーバーランすることなく、ライントレースが可能になりました。
